<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NutriPlate - Frontend</title>
  <style>body{font-family:Segoe UI,Arial;background:#f6f8fb;padding:24px}#app{max-width:420px;margin:24px auto;background:#fff;padding:18px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,.08)}img{max-width:100%}</style>
</head>
<body>
  <div id="app">
    <h2>NutriPlate (Frontend)</h2>
    <p>Pick an image to scan. Configure BACKEND_URL in <code>vercel.json</code> or edit the <code>API</code> constant below.</p>
    <input id="file" type="file" accept="image/*"><br/><br/>
    <button id="scan">Scan</button>
    <div id="status"></div>
    <pre id="out"></pre>
  </div>
  <script>
    // Set your backend URL here (example: https://your-backend.onrender.com)
    const API = (typeof BACKEND_URL !== 'undefined') ? BACKEND_URL : 'http://127.0.0.1:5000';
    const fileEl = document.getElementById('file');
    const status = document.getElementById('status');
    const out = document.getElementById('out');
    document.getElementById('scan').addEventListener('click', async ()=>{
      const f = fileEl.files[0];
      if(!f){status.textContent='Pick a file';return}
      status.textContent='Uploading...'; out.textContent='';
      const fd = new FormData(); fd.append('file', f);
      try{
        const r = await fetch(`${API}/scan`, {method:'POST', body: fd});
        if(!r.ok){ const t = await r.text().catch(()=>null); status.textContent = 'Server error: '+r.status; out.textContent = t; return }
        const j = await r.json(); status.textContent='OK'; out.textContent = JSON.stringify(j, null, 2);
      }catch(e){ status.textContent='Request failed'; out.textContent = String(e) }
    })
  </script>
</body>
</html>
